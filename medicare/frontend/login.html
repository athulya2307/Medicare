<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Medicare - Sign In</title>
    <link rel="stylesheet" href="css/style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body class="auth-page">
    <div class="auth-container">
      <!-- Branding -->
      <div class="auth-branding">
        <div class="logo">
          <i class="fas fa-heartbeat brand-icon"></i>
          <h1>Medicare</h1>
          <p>Your Complete Digital Healthcare Companion</p>
          <div class="features-list">
            <div class="feature-item">
              <i class="fas fa-check-circle"></i> Health Tracking
            </div>
            <div class="feature-item">
              <i class="fas fa-check-circle"></i> Doctor Booking
            </div>
            <div class="feature-item">
              <i class="fas fa-check-circle"></i> AI Reports
            </div>
          </div>
        </div>
      </div>

      <!-- Forms -->
      <div class="auth-forms">
        <div class="form-tabs">
          <button class="tab-btn active" onclick="showLogin()">Sign In</button>
          <button class="tab-btn" onclick="showSignup()">Sign Up</button>
        </div>

        <!-- Login Form -->
        <form
          id="loginForm"
          class="auth-form active"
          onsubmit="loginUser(event)"
        >
          <div class="form-group">
            <label>Email</label>
            <input
              type="email"
              id="loginEmail"
              placeholder="Enter your email"
              required
            />
          </div>
          <div class="form-group">
            <label>Password</label>
            <input
              type="password"
              id="loginPassword"
              placeholder="Enter your password"
              required
            />
          </div>
          <button type="submit" class="btn-primary full-width">Sign In</button>
        </form>

        <!-- Signup Form -->
        <form id="signupForm" class="auth-form" onsubmit="signupUser(event)">
          <div class="form-group">
            <label>Full Name</label>
            <input
              type="text"
              id="userName"
              placeholder="Enter your full name"
              required
            />
          </div>
          <div class="form-group">
            <label>Email</label>
            <input
              type="email"
              id="userEmail"
              placeholder="Enter your email"
              required
            />
          </div>
          <div class="form-group">
            <label>User Type</label>
            <select id="userRole" required>
              <option value="">Select type</option>
              <option value="patient">Patient</option>
              <option value="doctor">Doctor</option>
            </select>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Password</label>
              <input
                type="password"
                id="userPassword"
                placeholder="Create password"
                required
              />
            </div>
            <div class="form-group">
              <label>Confirm Password</label>
              <input
                type="password"
                id="userConfirmPassword"
                placeholder="Confirm password"
                required
              />
            </div>
          </div>
          <!-- ✅ CREATE ACCOUNT BUTTON - WORKS 100%! -->
          <button
            type="submit"
            class="btn-primary full-width"
            id="createAccountBtn"
          >
            Create Account & Go to Dashboard
          </button>
        </form>

        <div class="auth-footer">
          <button
            type="button"
            class="btn-google"
            onclick="alert('Google coming soon!')"
          >
            Continue with Google
          </button>
          <p>
            By signing up, you agree to our <a href="#">Terms</a> and
            <a href="#">Privacy Policy</a>
          </p>
        </div>
      </div>
    </div>

    <!-- ✅ DEAD-SIMPLE JS - NO CLASSES, NO PROBLEMS -->
    <script>
      // Tab switching
      function showLogin() {
        document.getElementById("loginForm").style.display = "block";
        document.getElementById("signupForm").style.display = "none";
        document.querySelectorAll(".tab-btn")[0].classList.add("active");
        document.querySelectorAll(".tab-btn")[1].classList.remove("active");
      }

      function showSignup() {
        document.getElementById("loginForm").style.display = "none";
        document.getElementById("signupForm").style.display = "block";
        document.querySelectorAll(".tab-btn")[0].classList.remove("active");
        document.querySelectorAll(".tab-btn")[1].classList.add("active");
      }

      // ✅ LOGIN - Works instantly
      function loginUser(event) {
        event.preventDefault();
        const email = document.getElementById("loginEmail").value;
        saveUserAndRedirect(email, "patient", "Welcome User");
      }

      // ✅ SIGNUP - Create Account → Dashboard DIRECTLY
      function signupUser(event) {
        event.preventDefault();

        // Get values
        const name = document.getElementById("userName").value;
        const email = document.getElementById("userEmail").value;
        const role = document.getElementById("userRole").value;
        const password = document.getElementById("userPassword").value;
        const confirmPassword = document.getElementById(
          "userConfirmPassword",
        ).value;

        // Validation
        if (
          !name ||
          !email ||
          !role ||
          password.length < 6 ||
          password !== confirmPassword
        ) {
          alert(
            "Please check: All fields required, password 6+ chars, passwords match!",
          );
          return false;
        }

        // ✅ GO TO DASHBOARD with ZERO values
        saveUserAndRedirect(email, role, name);
      }

      // ✅ SAVE USER + DASHBOARD (ZERO metrics for new users)
      function saveUserAndRedirect(email, role, name) {
        const btn =
          document.getElementById("createAccountBtn") ||
          event.target.querySelector('button[type="submit"]');
        const originalText = btn.innerHTML;

        // Loading
        btn.innerHTML =
          'Creating Account... <i class="fas fa-spinner fa-spin"></i>';
        btn.disabled = true;

        // ✅ NEW USER with ZERO METRICS
        const newUser = {
          name: name,
          email: email,
          role: role,
          weight: 0,
          height: 0,
          bloodSugar: 0,
          bloodPressure: "0/0",
          bmi: 0,
          created: new Date().toLocaleString(),
        };

        localStorage.setItem("medicare_user", JSON.stringify(newUser));

        // Success
        btn.innerHTML = "✅ Account Created! Redirecting...";
        btn.style.background = "#10b981";

        console.log("✅ User saved:", newUser);

        // ✅ DIRECT DASHBOARD - NO DELAY!
        setTimeout(() => {
          window.location.href = "dashboard.html";
        }, 1200);
      }
    </script>
  </body>
</html>
